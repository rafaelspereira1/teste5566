<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Upfunnels pixel -->
    <script>
      (function () {
        var ownerId = "6744cb1aeb3f7ee8ab5cd9b9";
        var urlParams = new URLSearchParams(window.location.search);
        var isPreview =
          urlParams.has("preview") && urlParams.get("preview") === "true";

        if (!isPreview) {
          function getCookie(name) {
            var match = document.cookie.match(
              new RegExp("(^| )" + name + "=([^;]+)")
            );
            if (match) return match[2];
          }

          function isLeadRefField(name) {
            if (!name) return false;

            name = name.toLowerCase();

            if (name === "leadref") return true;

            if (name.includes("[") && name.includes("]")) {
              var fieldMatch = name.match(/[(.*?)]/);
              if (fieldMatch && fieldMatch[1]) {
                var fieldName = fieldMatch[1].toLowerCase();
                return fieldName === "leadref";
              }
            }

            return false;
          }

          function findLeadRefInput(form) {
            var inputs = form.getElementsByTagName("input");
            return Array.from(inputs).find((input) =>
              isLeadRefField(input.name)
            );
          }

          function getOriginalLeadRefCase(form) {
            var inputs = form.getElementsByTagName("input");
            for (var input of inputs) {
              if (isLeadRefField(input.name)) {
                if (input.name.includes("[")) {
                  var match = input.name.match(/[(.*?)]/);
                  if (match) return match[1];
                }
                return input.name;
              }
            }

            var groups = form.querySelectorAll('[class*="field-group-"]');
            for (var group of groups) {
              var classes = Array.from(group.classList);
              var leadRefClass = classes.find(
                (cls) =>
                  cls.toLowerCase().includes("leadref") ||
                  cls.toLowerCase().includes("lead-ref") ||
                  cls.toLowerCase().includes("lead_ref")
              );
              if (leadRefClass) {
                var match = leadRefClass.match(/field-group-(.*)/i);
                if (match) return match[1];
              }
            }

            return "leadRef";
          }

          function getOrCreateLeadRefInput(form) {
            var existingLeadRef = findLeadRefInput(form);
            var cookieLeadRef =
              getCookie("leadRef") || Math.random().toString(36).substring(2);

            if (existingLeadRef) {
              existingLeadRef.value = cookieLeadRef;
              return existingLeadRef;
            } else {
              var isElementorForm = form.classList.contains("elementor-form");

              var hiddenInput = document.createElement("input");
              hiddenInput.type = "hidden";

              var leadRefName = getOriginalLeadRefCase(form);

              if (isElementorForm) {
                hiddenInput.name = "form_fields[" + leadRefName + "]";
                hiddenInput.className =
                  "elementor-field elementor-size-sm elementor-field-textual";

                hiddenInput.id = "form-field-" + leadRefName.toLowerCase();
              } else {
                hiddenInput.name = leadRefName;
              }

              hiddenInput.value = cookieLeadRef;

              if (isElementorForm) {
                var wrapper = document.createElement("div");
                var fieldGroupClass =
                  "elementor-field-group-" + leadRefName.toLowerCase();
                wrapper.className =
                  "elementor-field-type-hidden elementor-field-group elementor-column " +
                  fieldGroupClass +
                  " elementor-col-100";
                wrapper.appendChild(hiddenInput);

                var submitWrapper =
                  form.querySelector(".e-form__buttons") ||
                  form.querySelector(".elementor-form-fields-wrapper")
                    .lastElementChild;

                if (submitWrapper) {
                  submitWrapper.parentNode.insertBefore(wrapper, submitWrapper);
                } else {
                  form
                    .querySelector(".elementor-form-fields-wrapper")
                    .appendChild(wrapper);
                }
              } else {
                form.appendChild(hiddenInput);
              }

              return hiddenInput;
            }
          }

          function setupFormObserver() {
            processAllForms();

            var observer = new MutationObserver(function (mutations) {
              mutations.forEach(function (mutation) {
                mutation.addedNodes.forEach(function (node) {
                  if (node.nodeName === "FORM") {
                    getOrCreateLeadRefInput(node);
                  } else if (node.getElementsByTagName) {
                    var forms = node.getElementsByTagName("form");
                    Array.from(forms).forEach(function (form) {
                      getOrCreateLeadRefInput(form);
                    });
                  }
                });
              });
            });

            observer.observe(document.body, {
              childList: true,
              subtree: true,
            });
          }

          function processAllForms() {
            var forms = document.getElementsByTagName("form");
            Array.from(forms).forEach(function (form) {
              getOrCreateLeadRefInput(form);
            });
          }

          var leadRef =
            getCookie("leadRef") || Math.random().toString(36).substring(2);
          document.cookie = "leadRef=" + leadRef + ";path=/;";
          var apiUrl = "https://api.dev.upfunnels.com";
          var fullPath = window.location.href;
          var body = { leadRef: leadRef, fullPath: fullPath };
          var debugBody = { fullPath: fullPath };

          fetch(apiUrl + "/page/debug", {
            method: "POST",
            body: JSON.stringify(debugBody),
            headers: { "Content-Type": "application/json" },
          }).catch(console.error);

          fetch(apiUrl + "/visits/total", {
            method: "POST",
            body: JSON.stringify(body),
            headers: { "Content-Type": "application/json" },
          }).catch(console.error);

          fetch(apiUrl + "/visits/unique", {
            method: "POST",
            body: JSON.stringify(body),
            headers: { "Content-Type": "application/json" },
          }).catch(function (error) {
            if (error.response && error.response.status === 409) {
              console.log(error);
            }
          });

          fetch(apiUrl + "/leads/external/" + leadRef, {
            method: "PATCH",
            body: JSON.stringify({ fullPath: fullPath }),
            headers: { "Content-Type": "application/json" },
          }).catch(console.error);

          setInterval(function () {
            fetch(apiUrl + "/visits/total", {
              method: "POST",
              body: JSON.stringify(body),
              headers: { "Content-Type": "application/json" },
            }).catch(console.error);
          }, 2 * 60 * 60 * 1000);

          if (document.readyState === "loading") {
            document.addEventListener("DOMContentLoaded", setupFormObserver);
          } else {
            setupFormObserver();
          }
        }
      })();
    </script>
    <!-- Upfunnels pixel -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contact Form</title>
    <style>
      .form-container {
        max-width: 500px;
        margin: 2rem auto;
        padding: 2rem;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }

      .form-group {
        margin-bottom: 1rem;
      }

      label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: bold;
      }

      input,
      select {
        width: 100%;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        box-sizing: border-box;
      }

      button {
        background-color: #4caf50;
        color: white;
        padding: 10px 15px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        width: 100%;
      }

      button:hover {
        background-color: #45a049;
      }

      @media (max-width: 600px) {
        .form-container {
          margin: 1rem;
          padding: 1rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="form-container">
      <form id="contactForm">
        <div class="form-group">
          <label for="name">Name:</label>
          <input type="text" id="name" name="name" required />
        </div>

        <div class="form-group">
          <label for="email">Email:</label>
          <input type="email" id="email" name="email" required />
        </div>

        <div class="form-group">
          <label for="telephone">Telephone:</label>
          <input
            type="tel"
            id="telephone"
            name="telephone"
            pattern="[0-9]{10,}"
            title="Please enter at least 10 digits"
            required
          />
        </div>

        <div class="form-group">
          <label for="country">Country:</label>
          <select id="country" name="country" required>
            <option value="">Select a country</option>
            <option value="US">United States</option>
            <option value="UK">United Kingdom</option>
            <option value="CA">Canada</option>
            <option value="AU">Australia</option>
            <option value="Other">Other</option>
          </select>
        </div>

        <button type="submit">Submit</button>
      </form>
    </div>
  </body>
</html>
